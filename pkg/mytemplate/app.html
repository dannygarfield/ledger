<!doctype html>
<html>
    <head>
        <title>budget</title>
        <style>
            body {
              background: cornsilk;
              color: darkslategrey;
            }
        </style>
    </head>
    <body>
        <h1>Budget via JSON</h1>
        <ul class="errors">
        </ul>
        <table class="budget">
            <thead>
            <tr>
                <th>Date</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
        <h1>Insert a budget entry</h1>
        <form action="" method="POST">
            <label for="happened_at">happened_at:</label><br>
            <input type="text" id="happened_at" name="happened_at" value=""><br>

            <label for="amount">amount:</label><br>
            <input type="text" id="amount" name="amount" value=""><br>

            <label for="category">category:</label><br>
            <input type="text" id="category" name="category" value=""><br>

            <label for="description">description:</label><br>
            <input type="text" id="description" name="description" value=""><br><br>

          <input type="submit" value="Submit" onclick="submitEntry()">
        </form>
        <script>
            window.addEventListener("load", function () {
            fetch("/budget.json")
              .then(r => r.json())
              .then(entries => {
                  console.log("body", entries)
                  const table = document.querySelector('.budget tbody')
                  entries.forEach(entry => {
                      const tr = document.createElement('tr')
                      const date = document.createElement('td')
                      date.textContent = entry.EntryDate
                      tr.appendChild(date)
                      const amount = document.createElement('td')
                      amount.textContent = entry.Amount
                      tr.appendChild(amount)
                      const category = document.createElement('td')
                      category.textContent = entry.Category
                      tr.appendChild(category)
                      const description = document.createElement('td')
                      description.textContent = entry.Description
                      tr.appendChild(description)
                      table.appendChild(tr)
                  })
              })
              .catch(e => {
                  console.error(e)
                  const errs = document.querySelector(".errors")
                  const li = document.createElement("li")
                  li.textContent = String(e)
                  errs.appendChild(li)
              })
            })
            function submitEntry() {
                // find form element
                //  parse form / extract values from inputs
                //  construct javascript object
                // call JSON.stringify(js object)
                // call fetch with method POST and with our stringified data
                // 

            }
        </script>
    </body>
</html>
